package schema

import (
	"fmt"
)

//
// Utilities for building table names.
//

// TODO: this is disguistingly bad, but with postgres table name limits,
// having table names be full length but saved to disk trimmed results in
// weird behaviors where queries can't find the table by the name.
func clipTableName(table string) string {
	return table[:63]
}

func TableIdToTableName(tableId string) string {
	return clipTableName(TABLE_PREFIX + CONNECTOR + tableId)
}

func TableNameToTableId(tableName string) string {
	// Assumes that table name was generated by TableIdToTableName.
	return tableName[len(TABLE_PREFIX)+len(CONNECTOR):]
}

//
// Utilities for building field names.
//

func DefaultFieldName(index int) string {
	return "field_" + fmt.Sprint(index)
}

func DefaultKeyName(index int) string {
	return "key_" + fmt.Sprint(index)
}
